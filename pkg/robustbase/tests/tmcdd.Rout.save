
R Under development (unstable) (2014-10-07 r66723) -- "Unsuffered Consequences"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## VT::16.10.2014 - modified from tmcd.R - to test the
> ## deterministic option of covMcd.
> ##
> library(robustbase)
> 
> source(system.file("xtraR/test_MCD.R", package = "robustbase"))#-> doMCDdata
> ##          ../inst/test_MCD.R
> 
> ## -- now do it:
> options(digits = 5)
> set.seed(101) # <<-- sub-sampling algorithm now based on R's RNG and seed
> doMCDdata(method="DETMCD")

Call:  doMCDdata(method = "DETMCD") 
Data Set               n   p  Half   LOG(obj)  Time [ms]
========================================================
               heart  12   2   7     5.678742 
Best subsample: 
[1]  1  3  4  5  7  9 11
Outliers:  0 
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  5.68 
Robust Estimate of Location:
height  weight  
  38.3    33.1  
Robust Estimate of Covariance:
        height  weight
height     157     303
weight     303     660
--------------------------------------------------------
            phosphor  18   2  10     7.732906 
Best subsample: 
 [1]  2  4  5  7  8  9 11 12 14 16
Outliers:  1 
[1] 6
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  7.73 
Robust Estimate of Location:
  inorg  organic  
   12.5     40.8  
Robust Estimate of Covariance:
         inorg  organic
inorg      136      110
organic    110      215
--------------------------------------------------------
            starsCYG  47   2  25    -8.028718 
Best subsample: 
 [1]  1  6 10 12 13 16 23 24 25 26 28 31 32 33 37 38 39 40 41 42 43 44 45 46 47
Outliers:  6 
[1]  7 11 14 20 30 34
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -8.03 
Robust Estimate of Location:
   log.Te  log.light  
     4.41       4.95  
Robust Estimate of Covariance:
           log.Te  log.light
log.Te     0.0171     0.0511
log.light  0.0511     0.3555
--------------------------------------------------------
           stackloss  21   3  12     6.577286 
Best subsample: 
 [1]  4  5  6  7  8  9 11 13 16 18 19 20
Outliers:  2 
[1] 1 2
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  6.58 
Robust Estimate of Location:
  Air.Flow  Water.Temp  Acid.Conc.  
      58.4        20.5        86.1  
Robust Estimate of Covariance:
            Air.Flow  Water.Temp  Acid.Conc.
Air.Flow        64.9       15.37       30.77
Water.Temp      15.4        9.55        8.05
Acid.Conc.      30.8        8.05       43.78
--------------------------------------------------------
             coleman  20   5  13     2.149184 
Best subsample: 
 [1]  3  4  5  7  8 12 13 14 16 17 18 19 20
Outliers:  2 
[1]  6 10
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  2.15 
Robust Estimate of Location:
  salaryP   fatherWc    sstatus  teacherSc  motherLev  
     2.76      41.08       2.76      25.01       6.27  
Robust Estimate of Covariance:
           salaryP  fatherWc  sstatus  teacherSc  motherLev
salaryP      0.464      3.51     2.55      0.531      0.130
fatherWc     3.514   1615.00   526.26     14.543     39.038
sstatus      2.551    526.26   244.38      7.684     13.529
teacherSc    0.531     14.54     7.68      1.401      0.606
motherLev    0.130     39.04    13.53      0.606      1.093
--------------------------------------------------------
            salinity  28   3  16     1.940763 
Best subsample: 
 [1]  1  8 10 12 13 14 15 17 18 20 21 22 25 26 27 28
Outliers:  2 
[1]  5 16
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  1.94 
Robust Estimate of Location:
   X1     X2     X3  
10.50   2.58  23.12  
Robust Estimate of Covariance:
          X1        X2     X3
X1  12.02759  -0.00504  -1.61
X2  -0.00504   4.24789  -2.15
X3  -1.61240  -2.14688   3.55
--------------------------------------------------------
                wood  20   5  13   -35.240819 
Best subsample: 
 [1]  1  2  3  5  9 11 12 13 14 15 17 18 20
Outliers:  4 
[1]  4  6  8 19
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -35.2 
Robust Estimate of Location:
   x1     x2     x3     x4     x5  
0.582  0.125  0.530  0.534  0.888  
Robust Estimate of Covariance:
           x1         x2         x3         x4         x5
x1   0.013252   2.28e-03   2.63e-03  -0.000809  -1.21e-03
x2   0.002284   7.01e-04   1.10e-03  -0.000256  -5.93e-05
x3   0.002626   1.10e-03   7.06e-03  -0.001395  -1.59e-05
x4  -0.000809  -2.56e-04  -1.40e-03   0.005384   3.28e-03
x5  -0.001213  -5.93e-05  -1.59e-05   0.003283   3.72e-03
--------------------------------------------------------
                 hbk  75   3  39    -1.045501 
Best subsample: 
 [1] 15 17 18 19 20 21 22 23 24 26 27 28 29 32 33 35 36 38 40 41 43 48 49 50 51
[26] 54 55 56 58 59 63 64 66 67 70 71 72 73 74
Outliers:  14 
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -1.05 
Robust Estimate of Location:
  X1    X2    X3  
1.54  1.78  1.69  
Robust Estimate of Covariance:
        X1      X2     X3
X1  1.6528  0.0741  0.171
X2  0.0741  1.6823  0.205
X3  0.1713  0.2055  1.562
--------------------------------------------------------
             Animals  28   2  15    14.555543 
Best subsample: 
 [1]  1  3  4  5 10 11 17 18 19 20 21 22 23 26 27
Outliers:  13 
 [1]  2  6  7  8  9 12 13 14 15 16 24 25 28
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  14.6 
Robust Estimate of Location:
 body  brain  
 18.7   64.9  
Robust Estimate of Covariance:
       body  brain
body   2511   4258
brain  4258  15257
--------------------------------------------------------
                milk  86   8  47   -28.844954 
Best subsample: 
 [1]  5  8  9 10 21 22 23 24 26 30 31 32 33 34 35 36 37 38 39 46 51 53 54 55 56
[26] 57 58 59 60 61 62 63 64 65 66 67 68 69 71 72 76 78 79 81 83 84 86
Outliers:  20 
 [1]  1  2  3 11 12 13 14 15 16 17 18 20 27 41 44 47 70 74 75 77
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -28.8 
Robust Estimate of Location:
    X1      X2      X3      X4      X5      X6      X7      X8  
  1.03   35.90   33.10   26.16   25.13   25.07  123.13   14.39  
Robust Estimate of Covariance:
          X1        X2        X3        X4        X5        X6        X7
X1  5.78e-07  0.000102  0.000203  0.000199  0.000176  0.000166  0.000756
X2  1.02e-04  2.169273  0.249774  0.195898  0.102289  0.252863  1.877192
X3  2.03e-04  0.249774  1.437224  1.064014  1.032367  1.060645  0.814605
X4  1.99e-04  0.195898  1.064014  0.846416  0.799216  0.813117  0.685967
X5  1.76e-04  0.102289  1.032367  0.799216  0.831137  0.812421  0.665012
X6  1.66e-04  0.252863  1.060645  0.813117  0.812421  0.855148  0.712302
X7  7.56e-04  1.877192  0.814605  0.685967  0.665012  0.712302  4.635520
X8  4.42e-06  0.251035  0.228237  0.155281  0.129196  0.148924  0.401989
          X8
X1  4.42e-06
X2  2.51e-01
X3  2.28e-01
X4  1.55e-01
X5  1.29e-01
X6  1.49e-01
X7  4.02e-01
X8  1.80e-01
--------------------------------------------------------
            bushfire  38   5  22    18.135810 
Best subsample: 
 [1]  1  2  3  4  5  6 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
Outliers:  16 
 [1]  7  8  9 10 11 12 29 30 31 32 33 34 35 36 37 38
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  18.1 
Robust Estimate of Location:
 V1   V2   V3   V4   V5  
105  147  274  218  279  
Robust Estimate of Covariance:
       V1     V2     V3    V4    V5
V1    567    439  -2771  -624  -509
V2    439    387  -1843  -376  -318
V3  -2771  -1843  16367  4021  3196
V4   -624   -376   4021  1059   827
V5   -509   -318   3196   827   652
--------------------------------------------------------
========================================================
> ##                vvvv no timing for 'R CMD Rdiff' outputs
> doMCDdata(nrep = 12, time=FALSE, method="DETMCD")

Call:  doMCDdata(nrep = 12, time = FALSE, method = "DETMCD") 
Data Set               n   p  Half   LOG(obj)  Time [ms]
========================================================
               heart  12   2   7     5.678742 
Best subsample: 
[1]  1  3  4  5  7  9 11
Outliers:  0 
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  5.68 
Robust Estimate of Location:
height  weight  
  38.3    33.1  
Robust Estimate of Covariance:
        height  weight
height     157     303
weight     303     660
--------------------------------------------------------
            phosphor  18   2  10     7.732906 
Best subsample: 
 [1]  2  4  5  7  8  9 11 12 14 16
Outliers:  1 
[1] 6
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  7.73 
Robust Estimate of Location:
  inorg  organic  
   12.5     40.8  
Robust Estimate of Covariance:
         inorg  organic
inorg      136      110
organic    110      215
--------------------------------------------------------
            starsCYG  47   2  25    -8.028718 
Best subsample: 
 [1]  1  6 10 12 13 16 23 24 25 26 28 31 32 33 37 38 39 40 41 42 43 44 45 46 47
Outliers:  6 
[1]  7 11 14 20 30 34
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -8.03 
Robust Estimate of Location:
   log.Te  log.light  
     4.41       4.95  
Robust Estimate of Covariance:
           log.Te  log.light
log.Te     0.0171     0.0511
log.light  0.0511     0.3555
--------------------------------------------------------
           stackloss  21   3  12     6.577286 
Best subsample: 
 [1]  4  5  6  7  8  9 11 13 16 18 19 20
Outliers:  2 
[1] 1 2
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  6.58 
Robust Estimate of Location:
  Air.Flow  Water.Temp  Acid.Conc.  
      58.4        20.5        86.1  
Robust Estimate of Covariance:
            Air.Flow  Water.Temp  Acid.Conc.
Air.Flow        64.9       15.37       30.77
Water.Temp      15.4        9.55        8.05
Acid.Conc.      30.8        8.05       43.78
--------------------------------------------------------
             coleman  20   5  13     2.149184 
Best subsample: 
 [1]  3  4  5  7  8 12 13 14 16 17 18 19 20
Outliers:  2 
[1]  6 10
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  2.15 
Robust Estimate of Location:
  salaryP   fatherWc    sstatus  teacherSc  motherLev  
     2.76      41.08       2.76      25.01       6.27  
Robust Estimate of Covariance:
           salaryP  fatherWc  sstatus  teacherSc  motherLev
salaryP      0.464      3.51     2.55      0.531      0.130
fatherWc     3.514   1615.00   526.26     14.543     39.038
sstatus      2.551    526.26   244.38      7.684     13.529
teacherSc    0.531     14.54     7.68      1.401      0.606
motherLev    0.130     39.04    13.53      0.606      1.093
--------------------------------------------------------
            salinity  28   3  16     1.940763 
Best subsample: 
 [1]  1  8 10 12 13 14 15 17 18 20 21 22 25 26 27 28
Outliers:  2 
[1]  5 16
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  1.94 
Robust Estimate of Location:
   X1     X2     X3  
10.50   2.58  23.12  
Robust Estimate of Covariance:
          X1        X2     X3
X1  12.02759  -0.00504  -1.61
X2  -0.00504   4.24789  -2.15
X3  -1.61240  -2.14688   3.55
--------------------------------------------------------
                wood  20   5  13   -35.240819 
Best subsample: 
 [1]  1  2  3  5  9 11 12 13 14 15 17 18 20
Outliers:  4 
[1]  4  6  8 19
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -35.2 
Robust Estimate of Location:
   x1     x2     x3     x4     x5  
0.582  0.125  0.530  0.534  0.888  
Robust Estimate of Covariance:
           x1         x2         x3         x4         x5
x1   0.013252   2.28e-03   2.63e-03  -0.000809  -1.21e-03
x2   0.002284   7.01e-04   1.10e-03  -0.000256  -5.93e-05
x3   0.002626   1.10e-03   7.06e-03  -0.001395  -1.59e-05
x4  -0.000809  -2.56e-04  -1.40e-03   0.005384   3.28e-03
x5  -0.001213  -5.93e-05  -1.59e-05   0.003283   3.72e-03
--------------------------------------------------------
                 hbk  75   3  39    -1.045501 
Best subsample: 
 [1] 15 17 18 19 20 21 22 23 24 26 27 28 29 32 33 35 36 38 40 41 43 48 49 50 51
[26] 54 55 56 58 59 63 64 66 67 70 71 72 73 74
Outliers:  14 
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -1.05 
Robust Estimate of Location:
  X1    X2    X3  
1.54  1.78  1.69  
Robust Estimate of Covariance:
        X1      X2     X3
X1  1.6528  0.0741  0.171
X2  0.0741  1.6823  0.205
X3  0.1713  0.2055  1.562
--------------------------------------------------------
             Animals  28   2  15    14.555543 
Best subsample: 
 [1]  1  3  4  5 10 11 17 18 19 20 21 22 23 26 27
Outliers:  13 
 [1]  2  6  7  8  9 12 13 14 15 16 24 25 28
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  14.6 
Robust Estimate of Location:
 body  brain  
 18.7   64.9  
Robust Estimate of Covariance:
       body  brain
body   2511   4258
brain  4258  15257
--------------------------------------------------------
                milk  86   8  47   -28.844954 
Best subsample: 
 [1]  5  8  9 10 21 22 23 24 26 30 31 32 33 34 35 36 37 38 39 46 51 53 54 55 56
[26] 57 58 59 60 61 62 63 64 65 66 67 68 69 71 72 76 78 79 81 83 84 86
Outliers:  20 
 [1]  1  2  3 11 12 13 14 15 16 17 18 20 27 41 44 47 70 74 75 77
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  -28.8 
Robust Estimate of Location:
    X1      X2      X3      X4      X5      X6      X7      X8  
  1.03   35.90   33.10   26.16   25.13   25.07  123.13   14.39  
Robust Estimate of Covariance:
          X1        X2        X3        X4        X5        X6        X7
X1  5.78e-07  0.000102  0.000203  0.000199  0.000176  0.000166  0.000756
X2  1.02e-04  2.169273  0.249774  0.195898  0.102289  0.252863  1.877192
X3  2.03e-04  0.249774  1.437224  1.064014  1.032367  1.060645  0.814605
X4  1.99e-04  0.195898  1.064014  0.846416  0.799216  0.813117  0.685967
X5  1.76e-04  0.102289  1.032367  0.799216  0.831137  0.812421  0.665012
X6  1.66e-04  0.252863  1.060645  0.813117  0.812421  0.855148  0.712302
X7  7.56e-04  1.877192  0.814605  0.685967  0.665012  0.712302  4.635520
X8  4.42e-06  0.251035  0.228237  0.155281  0.129196  0.148924  0.401989
          X8
X1  4.42e-06
X2  2.51e-01
X3  2.28e-01
X4  1.55e-01
X5  1.29e-01
X6  1.49e-01
X7  4.02e-01
X8  1.80e-01
--------------------------------------------------------
            bushfire  38   5  22    18.135810 
Best subsample: 
 [1]  1  2  3  4  5  6 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
Outliers:  16 
 [1]  7  8  9 10 11 12 29 30 31 32 33 34 35 36 37 38
-------------
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  18.1 
Robust Estimate of Location:
 V1   V2   V3   V4   V5  
105  147  274  218  279  
Robust Estimate of Covariance:
       V1     V2     V3    V4    V5
V1    567    439  -2771  -624  -509
V2    439    387  -1843  -376  -318
V3  -2771  -1843  16367  4021  3196
V4   -624   -376   4021  1059   827
V5   -509   -318   3196   827   652
--------------------------------------------------------
========================================================
> doMCDdata(nrep = 12, time=FALSE, method = "MASS")

Call:  doMCDdata(nrep = 12, time = FALSE, method = "MASS") 
Data Set               n   p  Half   LOG(obj)  Time [ms]
========================================================
               heart  12   2   7     5.678742 
Best subsample: 
[1]  1  3  4  5  7  9 11
Outliers:  0 
-------------
$center
height weight 
40.358 38.125 

$cov
       height weight
height 142.46 298.91
weight 298.91 679.01

$msg
[1] "0 singular samples of size 3 out of 220"

$crit
[1] 5.6787

$best
[1]  1  3  4  5  7  9 11

$n.obs
[1] 12

--------------------------------------------------------
            phosphor  18   2  10     6.878847 
Best subsample: 
 [1]  3  5  8  9 11 12 13 14 15 17
Outliers:  0 
-------------
$center
  inorg organic 
 15.215  39.385 

$cov
         inorg organic
inorg    95.47  116.49
organic 116.49  171.76

$msg
[1] "1 singular samples of size 3 out of 816"

$crit
[1] 6.8788

$best
 [1]  3  5  8  9 11 12 13 14 15 17

$n.obs
[1] 18

--------------------------------------------------------
            starsCYG  47   2  25    -8.031215 
Best subsample: 
 [1]  1  2  4  6  8 10 12 13 16 24 25 26 28 32 33 37 38 39 40 41 42 43 44 45 46
Outliers:  0 
-------------
$center
   log.Te log.light 
    4.409     4.949 

$cov
            log.Te log.light
log.Te    0.011789  0.035179
log.light 0.035179  0.244869

$msg
[1] "11 singular samples of size 3 out of 1500"

$crit
[1] -8.0312

$best
 [1]  1  2  4  6  8 10 12 13 16 24 25 26 28 32 33 37 38 39 40 41 42 43 44 45 46

$n.obs
[1] 47

--------------------------------------------------------
           stackloss  21   3  12     5.472581 
Best subsample: 
 [1]  4  5  6  7  8  9 10 11 12 13 14 20
Outliers:  0 
-------------
$center
  Air.Flow Water.Temp Acid.Conc. 
    56.706     20.235     85.529 

$cov
           Air.Flow Water.Temp Acid.Conc.
Air.Flow    23.4706     7.5735    16.1029
Water.Temp   7.5735     6.3162     5.3676
Acid.Conc.  16.1029     5.3676    32.3897

$msg
[1] "90 singular samples of size 4 out of 2000"

$crit
[1] 5.4726

$best
 [1]  4  5  6  7  8  9 10 11 12 13 14 20

$n.obs
[1] 21

--------------------------------------------------------
             coleman  20   5  13     1.286808 
Best subsample: 
 [1]  2  3  4  5  7  8 12 13 14 16 17 19 20
Outliers:  0 
-------------
$center
  salaryP  fatherWc   sstatus teacherSc motherLev 
   2.8253   44.6267    4.7133   25.1240    6.3320 

$cov
           salaryP  fatherWc   sstatus teacherSc motherLev
salaryP    0.18916  -0.30888   0.14262   0.17971   0.02461
fatherWc  -0.30888 683.87325 196.89588   3.30523  17.29381
sstatus    0.14262 196.89588  85.94311   1.68507   5.58631
teacherSc  0.17971   3.30523   1.68507   0.51571   0.21891
motherLev  0.02461  17.29381   5.58631   0.21891   0.50172

$msg
[1] "0 singular samples of size 6 out of 3000"

$crit
[1] 1.2868

$best
 [1]  2  3  4  5  7  8 12 13 14 16 17 19 20

$n.obs
[1] 20

--------------------------------------------------------
            salinity  28   3  16     1.326364 
Best subsample: 
 [1]  1  2  6  7  8 12 13 14 18 20 21 22 25 26 27 28
Outliers:  0 
-------------
$center
     X1      X2      X3 
10.0826  2.7826 22.7777 

$cov
         X1       X2      X3
X1  9.14332  0.88241 -2.7916
X2  0.88241  3.35968 -1.2622
X3 -2.79160 -1.26222  2.0924

$msg
[1] "2 singular samples of size 4 out of 2000"

$crit
[1] 1.3264

$best
 [1]  1  2  6  7  8 12 13 14 18 20 21 22 25 26 27 28

$n.obs
[1] 28

--------------------------------------------------------
                wood  20   5  13   -36.270094 
Best subsample: 
 [1]  1  2  3  5  9 10 12 13 14 15 17 18 20
Outliers:  0 
-------------
$center
     x1      x2      x3      x4      x5 
0.57613 0.12294 0.53127 0.53760 0.88913 

$cov
            x1         x2          x3          x4          x5
x1  5.2757e-03 7.8749e-04  1.2965e-03 -2.0514e-05 -4.0002e-04
x2  7.8749e-04 2.2023e-04  5.4362e-04  2.3846e-05  2.7230e-05
x3  1.2965e-03 5.4362e-04  3.0435e-03 -7.0560e-04 -4.4395e-05
x4 -2.0514e-05 2.3846e-05 -7.0560e-04  2.1388e-03  1.3511e-03
x5 -4.0002e-04 2.7230e-05 -4.4395e-05  1.3511e-03  1.5946e-03

$msg
[1] "0 singular samples of size 6 out of 3000"

$crit
[1] -36.27

$best
 [1]  1  2  3  5  9 10 12 13 14 15 17 18 20

$n.obs
[1] 20

--------------------------------------------------------
                 hbk  75   3  39    -1.047858 
Best subsample: 
 [1] 15 16 17 18 19 20 21 22 23 24 26 27 31 32 33 35 36 37 38 40 43 49 50 51 54
[26] 55 56 58 59 61 63 64 66 67 70 71 72 73 74
Outliers:  0 
-------------
$center
    X1     X2     X3 
1.5583 1.8033 1.6600 

$cov
         X1       X2      X3
X1 1.124845 0.022175 0.15373
X2 0.022175 1.138972 0.18149
X3 0.153729 0.181492 1.04346

$msg
[1] "1 singular samples of size 4 out of 2000"

$crit
[1] -1.0479

$best
 [1] 15 16 17 18 19 20 21 22 23 24 26 27 31 32 33 35 36 37 38 40 43 49 50 51 54
[26] 55 56 58 59 61 63 64 66 67 70 71 72 73 74

$n.obs
[1] 75

--------------------------------------------------------
             Animals  28   2  15    14.555543 
Best subsample: 
 [1]  1  3  4  5 10 11 17 18 19 20 21 22 23 26 27
Outliers:  0 
-------------
$center
   body   brain 
 48.331 127.321 

$cov
        body   brain
body  4978.6  7801.4
brain 7801.4 21693.7

$msg
[1] "0 singular samples of size 3 out of 3276"

$crit
[1] 14.556

$best
 [1]  1  3  4  5 10 11 17 18 19 20 21 22 23 26 27

$n.obs
[1] 28

--------------------------------------------------------
                milk  86   8  47   -28.931843 
Best subsample: 
 [1]  5  7  8  9 10 22 23 24 26 30 31 32 33 34 35 37 38 39 45 46 51 53 54 55 56
[26] 57 58 59 60 61 63 64 65 66 67 68 69 71 72 76 78 79 81 83 84 86
Outliers:  0 
-------------
$center
      X1       X2       X3       X4       X5       X6       X7       X8 
  1.0302  35.7571  33.0540  26.1206  25.1000  25.0365 122.9397  14.3559 

$cov
           X1         X2         X3         X4         X5         X6         X7
X1 4.2168e-07 8.0438e-05 0.00016232 0.00015533 0.00013742 0.00012898 0.00056354
X2 8.0438e-05 1.4057e+00 0.19735023 0.14557604 0.09112903 0.17788018 1.15253456
X3 1.6232e-04 1.9735e-01 1.06155658 0.78306196 0.77129032 0.77961086 0.62201741
X4 1.5533e-04 1.4558e-01 0.78306196 0.62069636 0.59419355 0.59568612 0.50932924
X5 1.3742e-04 9.1129e-02 0.77129032 0.59419355 0.62419355 0.60209677 0.51435484
X6 1.2898e-04 1.7788e-01 0.77961086 0.59568612 0.60209677 0.62558116 0.51594726
X7 5.6354e-04 1.1525e+00 0.62201741 0.50932924 0.51435484 0.51594726 3.12630312
X8 3.1754e-06 1.0393e-01 0.15537148 0.10339299 0.08783871 0.09729826 0.19106964
           X8
X1 3.1754e-06
X2 1.0393e-01
X3 1.5537e-01
X4 1.0339e-01
X5 8.7839e-02
X6 9.7298e-02
X7 1.9107e-01
X8 1.0417e-01

$msg
[1] "29 singular samples of size 9 out of 3000"

$crit
[1] -28.932

$best
 [1]  5  7  8  9 10 22 23 24 26 30 31 32 33 34 35 37 38 39 45 46 51 53 54 55 56
[26] 57 58 59 60 61 63 64 65 66 67 68 69 71 72 76 78 79 81 83 84 86

$n.obs
[1] 86

--------------------------------------------------------
            bushfire  38   5  22    18.135810 
Best subsample: 
 [1]  1  2  3  4  5  6 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
Outliers:  0 
-------------
$center
    V1     V2     V3     V4     V5 
109.44 149.56 260.32 215.12 276.88 

$cov
         V1      V2       V3      V4      V5
V1   376.67  280.03 -1628.02 -342.01 -285.07
V2   280.03  236.42  -987.14 -188.82 -162.89
V3 -1628.02 -987.14 10203.64 2369.63 1917.58
V4  -342.01 -188.82  2369.63  589.94  468.56
V5  -285.07 -162.89  1917.58  468.56  375.19

$msg
[1] "0 singular samples of size 6 out of 3000"

$crit
[1] 18.136

$best
 [1]  1  2  3  4  5  6 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28

$n.obs
[1] 38

--------------------------------------------------------
========================================================
> 
> ###--- now the "close to singular" mahalanobis case:
> (c3 <- covMcd(mort3, nsamp="deterministic"))
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = mort3, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  38 
Robust Estimate of Location:
  MO70    MAGE    CI68    MDOC    DENS    NONW    EDUC    IN69  
111.41  286.52  164.44  155.62   19.50    2.24  556.46  107.68  
Robust Estimate of Covariance:
         MO70      MAGE     CI68     MDOC     DENS     NONW    EDUC    IN69
MO70   714.79   609.239   101.14   153.08    -6.05   16.844  -766.9  -135.3
MAGE   609.24   877.949    15.36   220.27   -93.80    0.297  -420.2    14.6
CI68   101.14    15.365   750.99  -280.92   -69.74    5.343  -783.1    44.9
MDOC   153.08   220.273  -280.92  1812.20    13.25    7.923   341.7    73.4
DENS    -6.05   -93.800   -69.74    13.25   159.82   11.822  -336.4   -60.6
NONW    16.84     0.297     5.34     7.92    11.82    2.868   -89.4   -10.6
EDUC  -766.90  -420.172  -783.08   341.66  -336.41  -89.394  6356.8   447.6
IN69  -135.30    14.609    44.91    73.42   -60.63  -10.622   447.6   162.2
> ## rescale variables:
> scaleV <- c(0.1, 0.1, 1, 1, .001, 0.1, 0.1, 100)
> mm <- data.matrix(mort3) * rep(scaleV, each = nrow(mort3))
> C3 <- covMcd(mm, nsamp="deterministic")
> stopifnot(C3$mcd.wt == c3$mcd.wt)
> try(## error: with "old default tolerance:
+   covMcd(mm, control= rrcov.control(tol = 1e-10), nsamp="deterministic")
+ )
Error in solve.default(cov, ...) : 
  system is computationally singular: reciprocal condition number = 2.71945e-11
> 
> cat('Time elapsed: ', proc.time(),'\n') # for ``statistical reasons''
Time elapsed:  1.57 0.18 1.74 NA NA 
> 
> ## "large" examples using different algo branches {seg.fault in version 0.4-4}:
> set.seed(1)
> 
> n <- 600 ## - partitioning will be triggered
> X <- matrix(round(100*rnorm(n * 3)), n, 3)
> cX <- covMcd(X, nsamp="deterministic")
> cX
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  25.1 
Robust Estimate of Location:
[1]  -0.0971  -6.4922  -0.5858
Robust Estimate of Covariance:
        [,1]     [,2]   [,3]
[1,]  9630.9    -51.5    369
[2,]   -51.5  11268.0    218
[3,]   369.3    217.8  11672
> n <- 2000 ## - nesting will be triggered
> X <- matrix(round(100*rnorm(n * 3)), n, 3)
> cX <- covMcd(X, nsamp="deterministic")
> cX
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X, nsamp = "deterministic")
-> Method:  Deterministic Minimum Covariance Determinant Estimator. 

Log(Det.):  25.1 
Robust Estimate of Location:
[1]   3.036  -0.604  -0.767
Robust Estimate of Covariance:
         [,1]  [,2]     [,3]
[1,]  10626.9  -863    -73.5
[2,]   -863.4  9971   -240.1
[3,]    -73.5  -240  10506.6
> 
> cat('Time elapsed: ', proc.time(),'\n')
Time elapsed:  1.96 0.18 2.13 NA NA 
> 
> 
> ## Now, some small sample cases:
> 
> ## maximal values:
> n. <- 10
> p. <-  8
> set.seed(44)
> (X. <- cbind(1:n., round(10*rt(n.,3)), round(10*rt(n.,2)),
+              matrix(round(10*rnorm(n. * (p.-3)), 1),  nrow = n., ncol = p.-3)))
      [,1] [,2] [,3]  [,4]  [,5]  [,6] [,7]  [,8]
 [1,]    1    8    0  -3.6   4.7   3.0 -7.7  -3.3
 [2,]    2  -24    3   5.7 -15.6  13.5 -8.9 -10.0
 [3,]    3   -1    0  17.0  -1.9  19.0 17.4  -5.8
 [4,]    4   -9    2   0.1  -6.0 -11.5 18.6  25.8
 [5,]    5   -6  -31   2.4  10.0   9.6  5.4  -4.8
 [6,]    6    6   -3 -12.3  -4.6  17.2 -4.6  15.2
 [7,]    7   22   16  -2.8  -2.2  -5.2 -2.2   5.6
 [8,]    8   23    5  -9.0 -10.4  -2.6 -5.7   2.0
 [9,]    9    1   -9   2.1  -5.6   4.1  2.8  -3.0
[10,]   10  -17   -2  -8.8  -7.8   6.5  4.2  17.7
> 
> ## 2 x 1 ---> Error
> r <- try(covMcd(X.[1:2, 2, drop=FALSE], nsamp="deterministic"), silent=TRUE)
> stopifnot(inherits(r, "try-error"),
+           grep("too small sample size", r) == 1)
> 
> ## 3 x 2 --- ditto
> r <- try(covMcd(X.[1:3, 2:3], nsamp="deterministic"), silent=TRUE)
> stopifnot(inherits(r, "try-error"),
+           grep("too small sample size", r) == 1)
> 
> cat('Time elapsed: ', proc.time(),'\n') # for ``statistical reasons''
Time elapsed:  1.96 0.18 2.13 NA NA 
> 
> proc.time()
   user  system elapsed 
   1.96    0.18    2.13 
