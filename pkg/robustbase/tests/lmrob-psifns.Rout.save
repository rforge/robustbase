
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ### tests psi und tuning.psi, tuning.chi argument of lmrob.control
> 
> library(robustbase)
> 
> data(aircraft)
> 
> set.seed(1)
> summary(mp0 <- lmrob(Y ~ ., data = aircraft, psi = 'bisquare', method = 'SMDM'))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "bisquare")

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-8.5550 -1.8394 -0.2113  2.8205 46.6316 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.8788153  6.5580833   1.049 0.308101    
X1          -3.2192167  1.0951206  -2.940 0.008762 ** 
X2           1.5876382  0.7471644   2.125 0.047702 *  
X3           0.0018265  0.0004310   4.238 0.000495 ***
X4          -0.0008677  0.0003699  -2.345 0.030664 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.335 
Convergence in 22 IRWLS iterations

Robustness weights: 
 observation 22 is an outlier with |weight| = 0 ( < 0.0043); 
 3 weights are ~= 1. The remaining 19 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3957  0.8772  0.9738  0.9139  0.9892  0.9972 
Algorithmic parameters: 
tuning.chi         bb tuning.psi refine.tol    rel.tol 
 1.5476400  0.5000000  4.6850610  0.0000001  0.0000001 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
       psi     method        cov 
"bisquare"     "SMDM"  ".vcov.w" 
seed : int(0) 
> 
> set.seed(2)
> summary(mp1 <- update(mp0, psi = 'optimal'))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "optimal")

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-6.6691 -2.4291  0.2249  3.8876 54.2841 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  9.5007403  5.6135731   1.692  0.10780   
X1          -3.0487969  0.9250865  -3.296  0.00402 **
X2           1.2100330  0.6534250   1.852  0.08053 . 
X3           0.0013810  0.0003949   3.497  0.00258 **
X4          -0.0005549  0.0003302  -1.680  0.11015   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 4.546 
Convergence in 1 IRWLS iterations

Robustness weights: 
 2 observations c(16,22) are outliers with |weight| = 0 ( < 0.0043); 
 21 weights are ~= 1.
Algorithmic parameters: 
tuning.chi         bb tuning.psi refine.tol    rel.tol 
 0.4047000  0.5000000  1.0601580  0.0000001  0.0000001 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
"optimal"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(3)
> summary(mp2 <- update(mp0, psi = 'ggw'))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "ggw")

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-8.4416 -1.7993 -0.1711  2.8466 47.0911 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.8194770  6.5601412   1.040 0.312320    
X1          -3.1718034  1.0963137  -2.893 0.009688 ** 
X2           1.5705466  0.7574903   2.073 0.052768 .  
X3           0.0017982  0.0004337   4.146 0.000606 ***
X4          -0.0008433  0.0003723  -2.265 0.036054 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.367 
Convergence in 20 IRWLS iterations

Robustness weights: 
 observation 22 is an outlier with |weight| <= 0.00044 ( < 0.0043); 
 16 weights are ~= 1. The remaining 6 ones are
     3      4     12     16     17     19 
0.9892 0.9891 0.8770 0.4138 0.9796 0.9839 
Algorithmic parameters: 
tuning.chi1 tuning.chi2 tuning.chi3 tuning.chi4          bb tuning.psi1 
   -5.0e-01     1.5e+00          NA     5.0e-01     5.0e-01    -5.0e-01 
tuning.psi2 tuning.psi3 tuning.psi4  refine.tol     rel.tol 
    1.5e+00     9.5e-01          NA     1.0e-07     1.0e-07 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
    "ggw"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(4)
> summary(mp3 <- update(mp0, psi = 'welsh'))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "welsh")

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-8.7243 -1.9199 -0.2471  2.8060 45.9436 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.6405293  6.5824954   1.009 0.326432    
X1          -3.2329190  1.1000586  -2.939 0.008776 ** 
X2           1.6174811  0.7474204   2.164 0.044149 *  
X3           0.0018656  0.0004297   4.342 0.000393 ***
X4          -0.0008941  0.0003695  -2.420 0.026345 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.408 
Convergence in 18 IRWLS iterations

Robustness weights: 
 observation 22 is an outlier with |weight| <= 0.0003 ( < 0.0043); 
 2 weights are ~= 1. The remaining 20 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4284  0.8583  0.9701  0.9112  0.9874  0.9985 
Algorithmic parameters: 
tuning.chi         bb tuning.psi refine.tol    rel.tol 
 0.5773502  0.5000000  2.1100000  0.0000001  0.0000001 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
  "welsh"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(5)
> summary(mp4 <- update(mp0, psi = 'ggw', tuning.psi = c(-.5, 1.5, 0.85, NA),
+                       tuning.chi = c(-0.5, 1.5, NA, 0.5)))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "ggw", 
    tuning.psi = c(-0.5, 1.5, 0.85, NA), tuning.chi = c(-0.5, 
        1.5, NA, 0.5))

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-7.2207 -2.2226  0.3446  3.5745 52.2885 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  9.6540916  6.6567809   1.450  0.16419   
X1          -3.2353135  1.0972643  -2.949  0.00859 **
X2           1.3343505  0.7654174   1.743  0.09834 . 
X3           0.0015256  0.0004630   3.295  0.00402 **
X4          -0.0006913  0.0003912  -1.767  0.09414 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.117 
Convergence in 15 IRWLS iterations

Robustness weights: 
 observation 22 is an outlier with |weight| <= 2.8e-08 ( < 0.0043); 
 15 weights are ~= 1. The remaining 7 ones are
      3       4      12      16      17      19      23 
0.87262 0.79602 0.73029 0.06024 0.96761 0.73117 0.97769 
Algorithmic parameters: 
tuning.chi1 tuning.chi2 tuning.chi3 tuning.chi4          bb tuning.psi1 
   -5.0e-01     1.5e+00          NA     5.0e-01     5.0e-01    -5.0e-01 
tuning.psi2 tuning.psi3 tuning.psi4  refine.tol     rel.tol 
    1.5e+00     8.5e-01          NA     1.0e-07     1.0e-07 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
    "ggw"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(6)
> summary(mp5 <- update(mp0, psi = 'ggw', tuning.psi = c(-.5, 1.0, 0.95, NA),
+                       tuning.chi = c(-0.5, 1.0, NA, 0.5)))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "ggw", 
    tuning.psi = c(-0.5, 1, 0.95, NA), tuning.chi = c(-0.5, 1, 
        NA, 0.5))

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-8.4170 -1.7441 -0.1319  2.8736 47.0427 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.7576867  6.1346963   1.102 0.285169    
X1          -3.1767049  1.0268466  -3.094 0.006266 ** 
X2           1.5753986  0.7099727   2.219 0.039582 *  
X3           0.0018001  0.0004032   4.465 0.000299 ***
X4          -0.0008430  0.0003470  -2.429 0.025823 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.501 
Convergence in 19 IRWLS iterations

Robustness weights: 
 21 weights are ~= 1. The remaining 2 ones are
      16       22 
0.423369 0.005032 
Algorithmic parameters: 
tuning.chi1 tuning.chi2 tuning.chi3 tuning.chi4          bb tuning.psi1 
   -5.0e-01     1.0e+00          NA     5.0e-01     5.0e-01    -5.0e-01 
tuning.psi2 tuning.psi3 tuning.psi4  refine.tol     rel.tol 
    1.0e+00     9.5e-01          NA     1.0e-07     1.0e-07 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
    "ggw"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(7)
> summary(mp6 <- update(mp0, psi = 'hampel'))

Call:
lmrob(formula = Y ~ ., data = aircraft, method = "SMDM", psi = "hampel")

Weighted Residuals:
   Min     1Q Median     3Q    Max 
-8.706 -1.937 -0.234  2.825 46.038 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.4302524  6.8596212   0.937 0.360958    
X1          -3.1885600  1.1496681  -2.773 0.012529 *  
X2           1.6223574  0.7928909   2.046 0.055637 .  
X3           0.0018589  0.0004496   4.134 0.000623 ***
X4          -0.0008851  0.0003876  -2.284 0.034755 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 5.473 
Convergence in 11 IRWLS iterations

Robustness weights: 
 observation 22 is an outlier with |weight| = 0 ( < 0.0043); 
 20 weights are ~= 1. The remaining 2 ones are
    12     16 
0.8503 0.4973 
Algorithmic parameters: 
tuning.chi1 tuning.chi2 tuning.chi3          bb tuning.psi1 tuning.psi2 
  0.3178745   0.7417071   1.6953304   0.5000000   1.3524128   3.1556298 
tuning.psi3  refine.tol     rel.tol 
  7.2128680   0.0000001   0.0000001 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
      psi    method       cov 
 "hampel"    "SMDM" ".vcov.w" 
seed : int(0) 
> 
> set.seed(8)
> ctrl <- lmrob.control(psi = 'ggw', tuning.psi = c(-.3, 1.4, 0.95, NA),
+                       tuning.chi = c(-0.3, 1.4, NA, 0.5))
> ctrl$tuning.psi
[1] -0.30  1.40  0.95    NA
attr(,"constants")
[1] 0.0000000 2.0011562 1.4000000 0.4125717 5.6874488
> ctrl$tuning.chi
[1] -0.3  1.4   NA  0.5
attr(,"constants")
[1] 0.00000000 0.24044569 1.40000000 0.09081713 0.27558437
> summary(mp7 <-lmrob(Y ~ ., data = aircraft, control = ctrl))

Call:
lmrob(formula = Y ~ ., data = aircraft, control = ctrl)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-9.8866 -2.3922 -0.2697  3.4834 40.8709 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  4.5387452 11.9653315   0.379  0.70888   
X1          -3.2901515  0.9367618  -3.512  0.00249 **
X2           1.8046426  0.8338085   2.164  0.04413 * 
X3           0.0021491  0.0011857   1.812  0.08664 . 
X4          -0.0010722  0.0007117  -1.507  0.14928   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Robust residual standard error: 6.112 
Convergence in 29 IRWLS iterations

Robustness weights: 
 10 weights are ~= 1. The remaining 13 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.03809 0.80160 0.89680 0.81710 0.96670 0.99400 
Algorithmic parameters: 
tuning.chi1 tuning.chi2 tuning.chi3 tuning.chi4          bb tuning.psi1 
   -3.0e-01     1.4e+00          NA     5.0e-01     5.0e-01    -3.0e-01 
tuning.psi2 tuning.psi3 tuning.psi4  refine.tol     rel.tol 
    1.4e+00     9.5e-01          NA     1.0e-07     1.0e-07 
 nResample     max.it     groups    n.group   best.r.s   k.fast.s      k.max 
       500         50          5        400          2          1        200 
 trace.lev compute.rd  numpoints 
         0          0         10 
          psi        method           cov 
        "ggw"          "MM" ".vcov.avar1" 
seed : int(0) 
> 
> 
