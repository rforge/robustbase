
R version 2.8.0 Patched (2008-11-27 r47025)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #### Test special cases  for  covMcd()
> 
> library(robustbase)
> 
> ### 1) p = 1 ----------------------------------------------------
> set.seed(1)
> x <- c(rnorm(50),100, 1e10)
> (r1 <- covMcd(x))
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x)
-> Method:  Univariate location and scale estimation. 

Log(Det.):  -2.130 
Robust Estimate of Location:
     x  
0.1922  
Robust Estimate of Covariance:
        x
x  0.7483
> str(r1)
List of 14
 $ method    : chr "Univariate location and scale estimation."
 $ call      : language covMcd(x = x)
 $ cov       : num [1, 1] 0.748
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "x"
  .. ..$ : chr "x"
 $ center    : Named num 0.192
  ..- attr(*, "names")= chr "x"
 $ n.obs     : int 52
 $ alpha     : num 0.5
 $ quan      : num 27
 $ raw.cov   : num [1, 1] 0.839
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "x"
  .. ..$ : chr "x"
 $ raw.center: Named num 0.325
  ..- attr(*, "names")= chr "x"
 $ crit      : num 0.119
 $ mcd.wt    : num [1:52] 1 1 1 1 1 1 1 1 1 1 ...
 $ X         : num [1:52, 1] -0.626 0.184 -0.836 1.595 0.33 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:52] "1" "2" "3" "4" ...
  .. ..$ : NULL
 $ raw.cnp2  : num [1:2] 6.45 1.14
 $ cnp2      : num [1:2] 1.47 1.01
 - attr(*, "class")= chr "mcd"
> summary(r1)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x)
-> Method:  Univariate location and scale estimation. 

Log(Det.):  -2.130 
Robust Estimate of Location:
     x  
0.1922  
Robust Estimate of Covariance:
        x
x  0.7483
> ## with alpha = 1
> (r1.1 <- covMcd(x, alpha = 1))
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 52 observations 
are equal to the classical estimates. 

Log(Det.):  42.1 
Robust Estimate of Location:
    x  
2.059  
Robust Estimate of Covariance:
       x
x  223.9
> str(r1.1)
List of 14
 $ method    : chr "Minimum Covariance Determinant Estimator. \nThe minimum covariance determinant estimates based on 52 observations \nare equal t"| __truncated__
 $ call      : language covMcd(x = x, alpha = 1)
 $ cov       : num [1, 1] 224
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "x"
  .. ..$ : chr "x"
 $ center    : Named num 2.06
  ..- attr(*, "names")= chr "x"
 $ n.obs     : int 52
 $ alpha     : num 1
 $ quan      : num 52
 $ raw.cov   : num [1, 1] 1.92e+18
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "x"
  .. ..$ : chr "x"
 $ raw.center: Named num 1.92e+08
  ..- attr(*, "names")= chr "x"
 $ crit      : num 1.92e+18
 $ mcd.wt    : num [1:52] 1 1 1 1 1 1 1 1 1 1 ...
 $ X         : num [1:52, 1] -0.626 0.184 -0.836 1.595 0.33 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:52] "1" "2" "3" "4" ...
  .. ..$ : NULL
 $ raw.cnp2  : num [1:2] 1 1
 $ cnp2      : num [1:2] 1.14 1
 - attr(*, "class")= chr "mcd"
> summary(r1.1)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = x, alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 52 observations 
are equal to the classical estimates. 

Log(Det.):  42.1 
Robust Estimate of Location:
    x  
2.059  
Robust Estimate of Covariance:
       x
x  223.9
> 
> ### 1b) p = 1, constant scale
> (rc <- covMcd(rep(1,12)))
Initial scale 0 because more than 'h' (=7) observations are identical.
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = rep(1, 12))
-> Method:  Univariate location and scale estimation. 
Initial scale 0 because more than 'h' (=7) observations are identical.

Log(Det.):  -Inf 
Robust Estimate of Location:
rep(1, 12)  
         1  
Robust Estimate of Covariance:
            rep(1, 12)
rep(1, 12)           0
> str(rc)
List of 15
 $ method     : chr "Univariate location and scale estimation."
 $ call       : language covMcd(x = rep(1, 12))
 $ singularity:List of 2
  ..$ kind: chr "identicalObs"
  ..$ q   : num 7
 $ cov        : num [1, 1] 0
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "rep(1, 12)"
  .. ..$ : chr "rep(1, 12)"
 $ raw.cov    : num [1, 1] 0
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "rep(1, 12)"
  .. ..$ : chr "rep(1, 12)"
 $ center     : Named num 1
  ..- attr(*, "names")= chr "rep(1, 12)"
 $ raw.center : Named num 1
  ..- attr(*, "names")= chr "rep(1, 12)"
 $ n.obs      : int 12
 $ alpha      : num 0.5
 $ quan       : num 7
 $ crit       : num 0
 $ mcd.wt     : num [1:12] 1 1 1 1 1 1 1 1 1 1 ...
 $ X          : num [1:12, 1] 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:12] "1" "2" "3" "4" ...
  .. ..$ : NULL
 $ raw.cnp2   : num [1:2] 4.97 1.41
 $ cnp2       : num [1:2] 1 1
 - attr(*, "class")= chr "mcd"
> summary(rc)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = rep(1, 12))
-> Method:  Univariate location and scale estimation. 
Initial scale 0 because more than 'h' (=7) observations are identical.

Log(Det.):  -Inf 
Robust Estimate of Location:
rep(1, 12)  
         1  
Robust Estimate of Covariance:
            rep(1, 12)
rep(1, 12)           0
> ## with alpha = 1
> (rc1 <- covMcd(rep(1,12), alpha = 1))
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = rep(1, 12), alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 12 observations 
are equal to the classical estimates. 
The classical covariance matrix is singular.

Log(Det.):  -Inf 
Robust Estimate of Location:
rep(1, 12)  
         1  
Robust Estimate of Covariance:
            rep(1, 12)
rep(1, 12)           0
> str(rc1)
List of 15
 $ method     : chr "Minimum Covariance Determinant Estimator. \nThe minimum covariance determinant estimates based on 12 observations \nare equal t"| __truncated__
 $ call       : language covMcd(x = rep(1, 12), alpha = 1)
 $ cov        : num [1, 1] 0
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "rep(1, 12)"
  .. ..$ : chr "rep(1, 12)"
 $ center     : Named num 1
  ..- attr(*, "names")= chr "rep(1, 12)"
 $ n.obs      : int 12
 $ singularity:List of 1
  ..$ kind: chr "classical"
 $ alpha      : num 1
 $ quan       : num 12
 $ raw.cov    : num [1, 1] 0
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr "rep(1, 12)"
  .. ..$ : chr "rep(1, 12)"
 $ raw.center : Named num 1
  ..- attr(*, "names")= chr "rep(1, 12)"
 $ crit       : num 0
 $ mcd.wt     : num [1:12] 1 1 1 1 1 1 1 1 1 1 ...
 $ X          : num [1:12, 1] 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:12] "1" "2" "3" "4" ...
  .. ..$ : NULL
 $ raw.cnp2   : num [1:2] 1 1
 $ cnp2       : num [1:2] 1 1
 - attr(*, "class")= chr "mcd"
> summary(rc1)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = rep(1, 12), alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 12 observations 
are equal to the classical estimates. 
The classical covariance matrix is singular.

Log(Det.):  -Inf 
Robust Estimate of Location:
rep(1, 12)  
         1  
Robust Estimate of Covariance:
            rep(1, 12)
rep(1, 12)           0
> 
> ### 2)  constant observations  { multivariate scale == 0 } -----------
> (X <- matrix(rep(2*(1:4), 12), nrow = 12, byrow = TRUE))
      [,1] [,2] [,3] [,4]
 [1,]    2    4    6    8
 [2,]    2    4    6    8
 [3,]    2    4    6    8
 [4,]    2    4    6    8
 [5,]    2    4    6    8
 [6,]    2    4    6    8
 [7,]    2    4    6    8
 [8,]    2    4    6    8
 [9,]    2    4    6    8
[10,]    2    4    6    8
[11,]    2    4    6    8
[12,]    2    4    6    8
> (rC  <- covMcd(X))
The covariance matrix of the data is singular.
There are 12 observations (in the entire dataset of 12 obs.) lying on
the hyperplane with equation a_1*(x_i1 - m_1) + ... + a_p*(x_ip - m_p)
= 0 with (m_1,...,m_p) the mean of these observations and coefficients
a_i from the vector a <- c(1, 0, 0, 0)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X)
-> Method:  Minimum Covariance Determinant Estimator. 
The covariance matrix of the data is singular.
There are 12 observations (in the entire dataset of 12 obs.) lying on
the hyperplane with equation a_1*(x_i1 - m_1) + ... + a_p*(x_ip - m_p)
= 0 with (m_1,...,m_p) the mean of these observations and coefficients
a_i from the vector a <- c(1, 0, 0, 0)

Log(Det.):  -Inf 
Robust Estimate of Location:
[1]  2  4  6  8
Robust Estimate of Covariance:
      [,1]  [,2]  [,3]  [,4]
[1,]     0     0     0     0
[2,]     0     0     0     0
[3,]     0     0     0     0
[4,]     0     0     0     0
> summary(rC)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X)
-> Method:  Minimum Covariance Determinant Estimator. 
The covariance matrix of the data is singular.
There are 12 observations (in the entire dataset of 12 obs.) lying on
the hyperplane with equation a_1*(x_i1 - m_1) + ... + a_p*(x_ip - m_p)
= 0 with (m_1,...,m_p) the mean of these observations and coefficients
a_i from the vector a <- c(1, 0, 0, 0)

Log(Det.):  -Inf 
Robust Estimate of Location:
[1]  2  4  6  8
Robust Estimate of Covariance:
      [,1]  [,2]  [,3]  [,4]
[1,]     0     0     0     0
[2,]     0     0     0     0
[3,]     0     0     0     0
[4,]     0     0     0     0
> (rC1 <- covMcd(X, alpha = 1))
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X, alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 12 observations 
are equal to the classical estimates. 
The classical covariance matrix is singular.

Log(Det.):  -Inf 
Robust Estimate of Location:
[1]  2  4  6  8
Robust Estimate of Covariance:
      [,1]  [,2]  [,3]  [,4]
[1,]     0     0     0     0
[2,]     0     0     0     0
[3,]     0     0     0     0
[4,]     0     0     0     0
> summary(rC1)
Minimum Covariance Determinant (MCD) estimator.
Call:
covMcd(x = X, alpha = 1)
-> Method:  Minimum Covariance Determinant Estimator. 
The minimum covariance determinant estimates based on 12 observations 
are equal to the classical estimates. 
The classical covariance matrix is singular.

Log(Det.):  -Inf 
Robust Estimate of Location:
[1]  2  4  6  8
Robust Estimate of Covariance:
      [,1]  [,2]  [,3]  [,4]
[1,]     0     0     0     0
[2,]     0     0     0     0
[3,]     0     0     0     0
[4,]     0     0     0     0
> 
> ### 3)  alpha = 1 : classical estimates --- for general cases --------
> 
> 
> cat('Time elapsed: ', proc.time(),'\n') # for ``statistical reasons''
Time elapsed:  0.456 0.145 0.633 0 0 
> 
