
R version 2.5.1 Patched (2007-07-18 r42269)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> #### Testing  medcouple  and related functions
> 
> library(robustbase)
> source(system.file("mcnaive.R", package = "robustbase"))# mcNaive()
> 
> system.time(stopifnot(0 == sapply(1:100, function(n) mc(seq_len(n)))))
   user  system elapsed 
  0.060   0.000   0.063 
> system.time(stopifnot(0 == sapply(1:100, function(n) mc(seq_len(n), doRefl=FALSE))))
   user  system elapsed 
  0.056   0.000   0.054 
> 
> 
> ## This is somewhat interesting {diff the output !}
> ## particularly since *most* give  the  'not found' diagnostic
> set.seed(17)
> for(n in 1:100) {
+     cat(sprintf("n =%3d:\n------\n", n))
+     mcval <- mc(rlnorm(n), trace=TRUE, doRefl=FALSE)
+     cat(sprintf(" --> mc(rlnorm(%d)) = %g\n", n, mcval))
+ }
n =  1:
------
 --> mc(rlnorm(1)) = 0
n =  2:
------
 --> mc(rlnorm(2)) = 0
n =  3:
------
Median = 0.847375 (not at the border)
 --> mc(rlnorm(3)) = 0
n =  4:
------
Median = 2.04417 (not at the border)
  not found [it=0,  (nr,nl) = (4,0)], -> (knew-nl, j-1) = (3,4)
 --> mc(rlnorm(4)) = -1.62509e-16
n =  5:
------
Median = 3.25694 (not at the border)
  not found [it=1,  (nr,nl) = (5,0)], -> (knew-nl, j-1) = (5,5)
 --> mc(rlnorm(5)) = -0.107345
n =  6:
------
Median = 1.87719 (not at the border)
  not found [it=1,  (nr,nl) = (5,0)], -> (knew-nl, j-1) = (5,5)
 --> mc(rlnorm(6)) = -0.362411
n =  7:
------
Median = 1.12459 (not at the border)
  not found [it=2,  (nr,nl) = (10,6)], -> (knew-nl, j-1) = (3,4)
 --> mc(rlnorm(7)) = 0.527099
n =  8:
------
Median = 0.399023 (not at the border)
  not found [it=2,  (nr,nl) = (9,7)], -> (knew-nl, j-1) = (2,2)
 --> mc(rlnorm(8)) = 0.00489829
n =  9:
------
Median = 0.813573 (not at the border)
  not found [it=2,  (nr,nl) = (14,11)], -> (knew-nl, j-1) = (2,3)
 --> mc(rlnorm(9)) = 0.665152
n = 10:
------
Median = 1.224 (not at the border)
  not found [it=2,  (nr,nl) = (15,10)], -> (knew-nl, j-1) = (3,5)
 --> mc(rlnorm(10)) = 0.336027
n = 11:
------
Median = 1.16303 (not at the border)
  not found [it=2,  (nr,nl) = (24,13)], -> (knew-nl, j-1) = (6,11)
 --> mc(rlnorm(11)) = 0.335301
n = 12:
------
Median = 0.701877 (not at the border)
  not found [it=2,  (nr,nl) = (23,14)], -> (knew-nl, j-1) = (5,9)
 --> mc(rlnorm(12)) = 0.360765
n = 13:
------
Median = 1.14961 (not at the border)
  not found [it=2,  (nr,nl) = (28,19)], -> (knew-nl, j-1) = (6,9)
 --> mc(rlnorm(13)) = 0.403639
n = 14:
------
Median = 0.693278 (not at the border)
  not found [it=3,  (nr,nl) = (33,24)], -> (knew-nl, j-1) = (1,9)
 --> mc(rlnorm(14)) = 0.700385
n = 15:
------
Median = 1.39603 (not at the border)
  not found [it=2,  (nr,nl) = (35,22)], -> (knew-nl, j-1) = (11,13)
 --> mc(rlnorm(15)) = 0.471475
n = 16:
------
Median = 0.993696 (not at the border)
  not found [it=3,  (nr,nl) = (34,24)], -> (knew-nl, j-1) = (9,10)
 --> mc(rlnorm(16)) = 0.316894
n = 17:
------
Median = 1.06594 (not at the border)
  not found [it=3,  (nr,nl) = (44,37)], -> (knew-nl, j-1) = (4,7)
 --> mc(rlnorm(17)) = 0.496123
n = 18:
------
Median = 0.752636 (not at the border)
  not found [it=3,  (nr,nl) = (56,40)], -> (knew-nl, j-1) = (1,16)
 --> mc(rlnorm(18)) = 0.412646
n = 19:
------
Median = 0.607121 (not at the border)
  not found [it=3,  (nr,nl) = (62,48)], -> (knew-nl, j-1) = (3,14)
 --> mc(rlnorm(19)) = 0.707461
n = 20:
------
Median = 0.734745 (not at the border)
  not found [it=3,  (nr,nl) = (51,34)], -> (knew-nl, j-1) = (17,17)
 --> mc(rlnorm(20)) = 0.741001
n = 21:
------
Median = 0.962639 (not at the border)
  not found [it=3,  (nr,nl) = (79,58)], -> (knew-nl, j-1) = (3,21)
 --> mc(rlnorm(21)) = 0.713546
n = 22:
------
Median = 0.623584 (not at the border)
  not found [it=3,  (nr,nl) = (61,47)], -> (knew-nl, j-1) = (14,14)
 --> mc(rlnorm(22)) = 0.624709
n = 23:
------
Median = 1.27168 (not at the border)
  not found [it=3,  (nr,nl) = (82,60)], -> (knew-nl, j-1) = (13,22)
 --> mc(rlnorm(23)) = 0.488602
n = 24:
------
Median = 1.1221 (not at the border)
  not found [it=3,  (nr,nl) = (85,62)], -> (knew-nl, j-1) = (11,23)
 --> mc(rlnorm(24)) = 0.310879
n = 25:
------
Median = 1.07368 (not at the border)
  not found [it=4,  (nr,nl) = (86,74)], -> (knew-nl, j-1) = (11,12)
 --> mc(rlnorm(25)) = 0.455712
n = 26:
------
Median = 0.838229 (not at the border)
  not found [it=3,  (nr,nl) = (86,61)], -> (knew-nl, j-1) = (24,25)
 --> mc(rlnorm(26)) = 0.269868
n = 27:
------
Median = 1.07424 (not at the border)
  not found [it=4,  (nr,nl) = (114,98)], -> (knew-nl, j-1) = (1,16)
 --> mc(rlnorm(27)) = 0.510525
n = 28:
------
Median = 1.03498 (not at the border)
  not found [it=3,  (nr,nl) = (103,82)], -> (knew-nl, j-1) = (17,21)
 --> mc(rlnorm(28)) = 0.423608
n = 29:
------
Median = 0.567121 (not at the border)
  not found [it=3,  (nr,nl) = (123,106)], -> (knew-nl, j-1) = (7,17)
 --> mc(rlnorm(29)) = 0.61519
n = 30:
------
Median = 1.19017 (not at the border)
  not found [it=3,  (nr,nl) = (130,110)], -> (knew-nl, j-1) = (3,20)
 --> mc(rlnorm(30)) = 0.128611
n = 31:
------
Median = 1.01222 (not at the border)
  not found [it=4,  (nr,nl) = (133,113)], -> (knew-nl, j-1) = (16,20)
 --> mc(rlnorm(31)) = 0.383694
n = 32:
------
Median = 1.49663 (not at the border)
  not found [it=3,  (nr,nl) = (139,112)], -> (knew-nl, j-1) = (17,27)
 --> mc(rlnorm(32)) = 0.352154
n = 33:
------
Median = 0.889278 (not at the border)
  not found [it=4,  (nr,nl) = (168,143)], -> (knew-nl, j-1) = (2,25)
 --> mc(rlnorm(33)) = 0.517069
n = 34:
------
Median = 0.918038 (not at the border)
  not found [it=3,  (nr,nl) = (156,131)], -> (knew-nl, j-1) = (14,25)
 --> mc(rlnorm(34)) = 0.190217
n = 35:
------
Median = 1.13929 (not at the border)
  not found [it=3,  (nr,nl) = (165,132)], -> (knew-nl, j-1) = (31,33)
 --> mc(rlnorm(35)) = 0.27165
n = 36:
------
Median = 0.889333 (not at the border)
  not found [it=3,  (nr,nl) = (178,147)], -> (knew-nl, j-1) = (16,31)
 --> mc(rlnorm(36)) = 0.423678
n = 37:
------
Median = 1.05539 (not at the border)
  not found [it=4,  (nr,nl) = (204,177)], -> (knew-nl, j-1) = (4,27)
 --> mc(rlnorm(37)) = 0.250077
n = 38:
------
Median = 1.12551 (not at the border)
  not found [it=4,  (nr,nl) = (192,176)], -> (knew-nl, j-1) = (5,16)
 --> mc(rlnorm(38)) = 0.140248
n = 39:
------
Median = 1.03316 (not at the border)
  not found [it=4,  (nr,nl) = (223,193)], -> (knew-nl, j-1) = (8,30)
 --> mc(rlnorm(39)) = 0.561994
n = 40:
------
Median = 1.39283 (not at the border)
  not found [it=4,  (nr,nl) = (217,194)], -> (knew-nl, j-1) = (7,23)
 --> mc(rlnorm(40)) = 0.262729
n = 41:
------
Median = 1.04459 (not at the border)
  not found [it=4,  (nr,nl) = (232,200)], -> (knew-nl, j-1) = (21,32)
 --> mc(rlnorm(41)) = 0.416359
n = 42:
------
Median = 1.03596 (not at the border)
  not found [it=4,  (nr,nl) = (228,197)], -> (knew-nl, j-1) = (24,31)
 --> mc(rlnorm(42)) = 0.115782
n = 43:
------
Median = 0.938235 (not at the border)
  not found [it=4,  (nr,nl) = (270,238)], -> (knew-nl, j-1) = (5,32)
 --> mc(rlnorm(43)) = 0.491648
n = 44:
------
Median = 1.03247 (not at the border)
  not found [it=4,  (nr,nl) = (259,222)], -> (knew-nl, j-1) = (21,37)
 --> mc(rlnorm(44)) = 0.40293
n = 45:
------
Median = 1.19818 (not at the border)
  not found [it=4,  (nr,nl) = (293,254)], -> (knew-nl, j-1) = (11,39)
 --> mc(rlnorm(45)) = 0.178041
n = 46:
------
Median = 0.823748 (not at the border)
  not found [it=4,  (nr,nl) = (275,242)], -> (knew-nl, j-1) = (23,33)
 --> mc(rlnorm(46)) = 0.550296
n = 47:
------
Median = 0.850011 (not at the border)
  not found [it=5,  (nr,nl) = (301,282)], -> (knew-nl, j-1) = (7,19)
 --> mc(rlnorm(47)) = 0.523371
n = 48:
------
Median = 0.984916 (not at the border)
  not found [it=4,  (nr,nl) = (328,284)], -> (knew-nl, j-1) = (5,44)
 --> mc(rlnorm(48)) = 0.372149
n = 49:
------
Median = 0.977565 (not at the border)
  not found [it=4,  (nr,nl) = (343,305)], -> (knew-nl, j-1) = (8,38)
 --> mc(rlnorm(49)) = 0.359081
n = 50:
------
Median = 1.321 (not at the border)
  not found [it=4,  (nr,nl) = (334,305)], -> (knew-nl, j-1) = (8,29)
 --> mc(rlnorm(50)) = 0.270815
n = 51:
------
Median = 0.663719 (not at the border)
  not found [it=3,  (nr,nl) = (361,313)], -> (knew-nl, j-1) = (26,48)
 --> mc(rlnorm(51)) = 0.809476
n = 52:
------
Median = 0.863617 (not at the border)
  not found [it=4,  (nr,nl) = (350,298)], -> (knew-nl, j-1) = (41,52)
 --> mc(rlnorm(52)) = 0.453604
n = 53:
------
Median = 0.869323 (not at the border)
  not found [it=4,  (nr,nl) = (401,355)], -> (knew-nl, j-1) = (10,46)
 --> mc(rlnorm(53)) = 0.463112
n = 54:
------
Median = 0.874467 (not at the border)
  not found [it=4,  (nr,nl) = (391,361)], -> (knew-nl, j-1) = (4,30)
 --> mc(rlnorm(54)) = 0.550312
n = 55:
------
Median = 1.2832 (not at the border)
  not found [it=4,  (nr,nl) = (398,364)], -> (knew-nl, j-1) = (29,34)
 --> mc(rlnorm(55)) = 0.292664
n = 56:
------
Median = 0.944194 (not at the border)
  not found [it=4,  (nr,nl) = (423,368)], -> (knew-nl, j-1) = (25,55)
 --> mc(rlnorm(56)) = 0.57353
n = 57:
------
Median = 0.834438 (not at the border)
  not found [it=4,  (nr,nl) = (424,377)], -> (knew-nl, j-1) = (44,47)
 --> mc(rlnorm(57)) = 0.559266
n = 58:
------
Median = 1.3469 (not at the border)
  not found [it=4,  (nr,nl) = (438,398)], -> (knew-nl, j-1) = (23,40)
 --> mc(rlnorm(58)) = 0.214333
n = 59:
------
Median = 1.13765 (not at the border)
  not found [it=5,  (nr,nl) = (481,449)], -> (knew-nl, j-1) = (2,32)
 --> mc(rlnorm(59)) = 0.424859
n = 60:
------
Median = 0.74878 (not at the border)
  not found [it=4,  (nr,nl) = (475,421)], -> (knew-nl, j-1) = (30,54)
 --> mc(rlnorm(60)) = 0.351161
n = 61:
------
Median = 1.18794 (not at the border)
  not found [it=4,  (nr,nl) = (531,477)], -> (knew-nl, j-1) = (4,54)
 --> mc(rlnorm(61)) = 0.249025
n = 62:
------
Median = 0.764012 (not at the border)
  not found [it=4,  (nr,nl) = (514,468)], -> (knew-nl, j-1) = (13,46)
 --> mc(rlnorm(62)) = 0.456371
n = 63:
------
Median = 1.0835 (not at the border)
  not found [it=5,  (nr,nl) = (524,497)], -> (knew-nl, j-1) = (16,27)
 --> mc(rlnorm(63)) = 0.504061
n = 64:
------
Median = 1.07216 (not at the border)
  not found [it=4,  (nr,nl) = (545,490)], -> (knew-nl, j-1) = (23,55)
 --> mc(rlnorm(64)) = 0.35258
n = 65:
------
Median = 0.98628 (not at the border)
  not found [it=4,  (nr,nl) = (571,510)], -> (knew-nl, j-1) = (35,61)
 --> mc(rlnorm(65)) = 0.534033
n = 66:
------
Median = 1.0057 (not at the border)
  not found [it=4,  (nr,nl) = (564,502)], -> (knew-nl, j-1) = (43,62)
 --> mc(rlnorm(66)) = 0.170391
n = 67:
------
Median = 1.10488 (not at the border)
  not found [it=5,  (nr,nl) = (603,566)], -> (knew-nl, j-1) = (13,37)
 --> mc(rlnorm(67)) = 0.273404
n = 68:
------
Median = 1.03721 (not at the border)
  not found [it=4,  (nr,nl) = (601,545)], -> (knew-nl, j-1) = (34,56)
 --> mc(rlnorm(68)) = 0.445825
n = 69:
------
Median = 1.04214 (not at the border)
  not found [it=4,  (nr,nl) = (630,562)], -> (knew-nl, j-1) = (51,68)
 --> mc(rlnorm(69)) = 0.426994
n = 70:
------
Median = 1.2122 (not at the border)
  not found [it=4,  (nr,nl) = (657,596)], -> (knew-nl, j-1) = (17,61)
 --> mc(rlnorm(70)) = 0.0869074
n = 71:
------
Median = 0.75431 (not at the border)
  not found [it=5,  (nr,nl) = (652,625)], -> (knew-nl, j-1) = (24,27)
 --> mc(rlnorm(71)) = 0.586925
n = 72:
------
Median = 0.881605 (not at the border)
  not found [it=4,  (nr,nl) = (691,628)], -> (knew-nl, j-1) = (21,63)
 --> mc(rlnorm(72)) = 0.493531
n = 73:
------
Median = 1.36469 (not at the border)
  not found [it=4,  (nr,nl) = (750,682)], -> (knew-nl, j-1) = (3,68)
 --> mc(rlnorm(73)) = 0.0724632
n = 74:
------
Median = 1.19573 (not at the border)
  not found [it=5,  (nr,nl) = (718,666)], -> (knew-nl, j-1) = (19,52)
 --> mc(rlnorm(74)) = 0.255581
n = 75:
------
Median = 0.95989 (not at the border)
  not found [it=4,  (nr,nl) = (729,671)], -> (knew-nl, j-1) = (52,58)
 --> mc(rlnorm(75)) = 0.366647
n = 76:
------
Median = 1.02703 (not at the border)
  not found [it=5,  (nr,nl) = (746,713)], -> (knew-nl, j-1) = (10,33)
 --> mc(rlnorm(76)) = 0.387911
n = 77:
------
Median = 0.924149 (not at the border)
  not found [it=5,  (nr,nl) = (778,716)], -> (knew-nl, j-1) = (45,62)
 --> mc(rlnorm(77)) = 0.415842
n = 78:
------
Median = 0.73153 (not at the border)
  not found [it=4,  (nr,nl) = (812,742)], -> (knew-nl, j-1) = (19,70)
 --> mc(rlnorm(78)) = 0.404619
n = 79:
------
Median = 0.836524 (not at the border)
  not found [it=5,  (nr,nl) = (822,773)], -> (knew-nl, j-1) = (28,49)
 --> mc(rlnorm(79)) = 0.396704
n = 80:
------
Median = 0.875466 (not at the border)
  not found [it=5,  (nr,nl) = (821,765)], -> (knew-nl, j-1) = (36,56)
 --> mc(rlnorm(80)) = 0.437883
n = 81:
------
Median = 0.949946 (not at the border)
  not found [it=5,  (nr,nl) = (851,787)], -> (knew-nl, j-1) = (54,64)
 --> mc(rlnorm(81)) = 0.482383
n = 82:
------
Median = 0.793115 (not at the border)
  not found [it=4,  (nr,nl) = (866,792)], -> (knew-nl, j-1) = (49,74)
 --> mc(rlnorm(82)) = 0.601821
n = 83:
------
Median = 0.777859 (not at the border)
  not found [it=5,  (nr,nl) = (910,860)], -> (knew-nl, j-1) = (23,50)
 --> mc(rlnorm(83)) = 0.52293
n = 84:
------
Median = 1.02484 (not at the border)
  not found [it=5,  (nr,nl) = (891,840)], -> (knew-nl, j-1) = (43,51)
 --> mc(rlnorm(84)) = 0.254919
n = 85:
------
Median = 0.733753 (not at the border)
  not found [it=5,  (nr,nl) = (956,914)], -> (knew-nl, j-1) = (11,42)
 --> mc(rlnorm(85)) = 0.59177
n = 86:
------
Median = 1.19888 (not at the border)
  not found [it=5,  (nr,nl) = (936,887)], -> (knew-nl, j-1) = (38,49)
 --> mc(rlnorm(86)) = 0.382632
n = 87:
------
Median = 0.973207 (not at the border)
  not found [it=5,  (nr,nl) = (1013,962)], -> (knew-nl, j-1) = (7,51)
 --> mc(rlnorm(87)) = 0.333662
n = 88:
------
Median = 0.931138 (not at the border)
  not found [it=4,  (nr,nl) = (1018,942)], -> (knew-nl, j-1) = (27,76)
 --> mc(rlnorm(88)) = 0.443169
n = 89:
------
Median = 0.785364 (not at the border)
  not found [it=5,  (nr,nl) = (1016,973)], -> (knew-nl, j-1) = (40,43)
 --> mc(rlnorm(89)) = 0.468986
n = 90:
------
Median = 1.08882 (not at the border)
  not found [it=5,  (nr,nl) = (1063,1012)], -> (knew-nl, j-1) = (1,51)
 --> mc(rlnorm(90)) = 0.186779
n = 91:
------
Median = 0.904577 (not at the border)
  not found [it=5,  (nr,nl) = (1064,1025)], -> (knew-nl, j-1) = (34,39)
 --> mc(rlnorm(91)) = 0.452084
n = 92:
------
Median = 0.903908 (not at the border)
  not found [it=5,  (nr,nl) = (1084,1044)], -> (knew-nl, j-1) = (15,40)
 --> mc(rlnorm(92)) = 0.321309
n = 93:
------
Median = 1.10834 (not at the border)
  not found [it=5,  (nr,nl) = (1122,1077)], -> (knew-nl, j-1) = (28,45)
 --> mc(rlnorm(93)) = 0.172696
n = 94:
------
Median = 1.10373 (not at the border)
  not found [it=5,  (nr,nl) = (1106,1049)], -> (knew-nl, j-1) = (56,57)
 --> mc(rlnorm(94)) = 0.309923
n = 95:
------
Median = 1.26121 (not at the border)
  not found [it=5,  (nr,nl) = (1183,1114)], -> (knew-nl, j-1) = (39,69)
 --> mc(rlnorm(95)) = 0.118623
n = 96:
------
Median = 1.02721 (not at the border)
  not found [it=5,  (nr,nl) = (1156,1111)], -> (knew-nl, j-1) = (42,45)
 --> mc(rlnorm(96)) = 0.357886
n = 97:
------
Median = 0.74626 (not at the border)
  not found [it=5,  (nr,nl) = (1272,1196)], -> (knew-nl, j-1) = (5,76)
 --> mc(rlnorm(97)) = 0.606728
n = 98:
------
Median = 1.182 (not at the border)
  not found [it=5,  (nr,nl) = (1266,1198)], -> (knew-nl, j-1) = (3,68)
 --> mc(rlnorm(98)) = 0.0272227
n = 99:
------
Median = 1.1647 (not at the border)
  not found [it=5,  (nr,nl) = (1266,1199)], -> (knew-nl, j-1) = (52,67)
 --> mc(rlnorm(99)) = 0.418596
n =100:
------
Median = 0.921319 (not at the border)
  not found [it=5,  (nr,nl) = (1314,1236)], -> (knew-nl, j-1) = (15,78)
 --> mc(rlnorm(100)) = 0.457971
> 
> system.time(
+ stopifnot(0 == sapply(1:100, function(n) mcNaive(seq_len(n), "simple")))
+ )
   user  system elapsed 
  0.112   0.004   0.115 
> system.time(
+ stopifnot(0 == sapply(1:100, function(n) mcNaive(seq_len(n), "h.use")))
+ )
   user  system elapsed 
  0.112   0.004   0.116 
> ## 0.26 (on nb-mm; just slightly slower than "simple"
> 
> x1 <- c(1, 2, 7, 9, 10)
> mcNaive(x1) # = -1/3
[1] -0.3333333
> stopifnot(all.equal(-1/3, mcNaive(x1), tol=1e-12),
+           all.equal(-1/3, mcNaive(x1, "h.use"), tol=1e-12),
+           all.equal(-1/3, mc(x1), tol = 1e-12))
> 
> x2 <- c(-1, 0, 0, 0, 1, 2)
> mcNaive(x2, meth="simple") # = 0 - which is wrong
[1] 0
> mcNaive(x2, meth="h.use")  # = 1/6 = 0.16666
[1] 0.1666667
> stopifnot(all.equal(1/6, mc(x2),               tol=1e-12),
+           all.equal(1/6, mcNaive(x2, "h.use"), tol=1e-12))
> 
> x3 <- c(-2, rep(-1,4), rep(0,6), 2, 2, 2:4)
> mcNaive(x3,"h.use") # 1/3
[1] 0.3333333
> mcNaive(x3,"simple")#  0
[1] 0
> 
> try( mc(x3, doRefl = FALSE, maxit = 15, trace = 3)) ## "non-convergence"
Median = 0 (not at the border)
 x[] is rescaled (* 1/s) with s = 8
   x1[] := {x | x_j > eps}         has 5 entries
'median-x' {x | -eps < x_i <= eps} has 6 (= 'k') entries
 (h1,h2,  nr=nr-nl, knew) = (11,11,  121, 61)
	it= 1, whimed(*, n=11, *)=     0 sum_(p,q)= (67,76); sum_p >= ..
	it= 2, whimed(*, n=11, *)=     1 sum_(p,q)= (0,45); s_p < kn ?<=? s_q: no
	it= 3, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 4, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 5, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 6, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 7, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 8, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it= 9, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=10, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=11, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=12, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=13, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=14, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
	it=15, whimed(*, n=5, *)= 0.333333 sum_(p,q)= (66,66); sum_p >= ..
maximal number of iterations (15) reached prematurely (it=16)
Error in mc.default(x3, doRefl = FALSE, maxit = 15, trace = 3) : 
	mc(): not 'converged' in 16 iterations
> str(robustbase:::mcComp(-x3, doRefl = FALSE, maxit = 15, trace = 3))
Median = -0 (not at the border)
 x[] is rescaled (* 1/s) with s = 8
   x1[] := {x | x_j > eps}         has 5 entries
'median-x' {x | -eps < x_i <= eps} has 6 (= 'k') entries
 (h1,h2,  nr=nr-nl, knew) = (11,11,  121, 61)
	it= 1, whimed(*, n=11, *)=     0 sum_(p,q)= (45,54); s_p < kn ?<=? s_q: no
	it= 2, whimed(*, n=10, *)=    -1 sum_(p,q)= (76,121); sum_p >= ..
	it= 3, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 4, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 5, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 6, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 7, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 8, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it= 9, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=10, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=11, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=12, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=13, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=14, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
	it=15, whimed(*, n=5, *)= -0.333333 sum_(p,q)= (55,55); s_p < kn ?<=? s_q: no
maximal number of iterations (15) reached prematurely (it=16)
List of 4
 $ medc     : num -0.333
 $ eps      : num [1:2] 1e-13 1e-13
 $ iter     : int 16
 $ converged: logi FALSE
> 
> set.seed(17)
> for(n in 3:50) {
+     cat(" ")
+     x <- rlnorm(n)
+     mc1 <- mc(x)
+     mc2 <- mcNaive(x)
+     mc3 <- mcNaive(x, method = "h.use")
+     stopifnot(all.equal(mc1, mc3, tol = 1e-12),
+               mc2 == mc3)
+ ## BUG: Fails (as 'x3' above)
+ ##     x <- round(2 * rnorm(n)) # many ties, often at median -- not converging
+ ##     mc1 <- mc(x)
+ ##     mc2 <- mcNaive(x)
+ ##     mc3 <- mcNaive(x, method = "h.use")
+ ##     stopifnot(mc1 == mc3)
+ ##     if(mc2 != mc3) cat("D!")
+     cat(".")
+ };  cat("\n")
 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
> 
